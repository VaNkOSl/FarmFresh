@using System.Security.Claims

<div class="mt-3">
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">Edit</a>
    <form asp-action="Delete" asp-route-id="@Model.Id" method="post" style="display:inline;">
        <button type="submit" class="btn btn-danger">Delete</button>
    </form>
</div>

<!-- Reviews Section -->
<h2 class="mt-4">Reviews</h2>

@if (Model.Reviews.Any())
{
    <ul class="list-group">
        @foreach (var review in Model.Reviews)
        {
            <li class="list-group-item">
                <strong>@review.User.UserName</strong> (@review.ReviewDate.ToShortDateString())
                <p><strong>Rating:</strong> @review.Rating / 5</p>
                <p>@review.Content</p>

                @if (review.UserId == Guid.Parse(User.FindFirstValue(ClaimTypes.NameIdentifier))) // Check if the current user wrote the review
                {
                    <div class="mt-2">
                        <a asp-action="EditReview" asp-route-reviewId="@review.Id" class="btn btn-warning btn-sm">Edit</a>
                        <form asp-action="DeleteReview" asp-route-reviewId="@review.Id" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                        </form>
                    </div>
                }
            </li>
        }
    </ul>
}
else
{
    <p>No reviews yet. Be the first to review this product!</p>
}
